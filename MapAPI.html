<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Gợi ý địa điểm TrackAsia</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #f4f4f4;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  input {
    width: 300px;
    padding: 6px;
    font-size: 14px;
  }
  .suggestions {
    border: 1px solid #ddd;
    max-width: 300px;
    background: #fff;
    position: absolute;
    z-index: 1000;
  }
  .suggestion-item {
    padding: 6px 10px;
    cursor: pointer;
  }
  .suggestion-item:hover {
    background-color: #0078d7;
    color: white;
  }
  .relative {
    position: relative;
  }
</style>
</head>
<body>

<div class="relative">
  <label for="origin">Điểm đi</label>
  <input id="origin" type="text" autocomplete="off" placeholder="Nhập điểm đi" />
  <div id="origin-suggestions" class="suggestions" style="display:none;"></div>
</div>

<div class="relative">
  <label for="destination">Điểm đến</label>
  <input id="destination" type="text" autocomplete="off" placeholder="Nhập điểm đến" />
  <div id="destination-suggestions" class="suggestions" style="display:none;"></div>
</div>

<script>
const apiKey = '0dfb3c4c83ebea6ae11754971709ddea53';

function fetchSuggestions(query, callback) {
  if (!query) {
    callback([]);
    return;
  }
  const url = `https://maps.track-asia.com/places/v2/autocomplete?key=${apiKey}&text=${encodeURIComponent(query)}&boundary.country=VN&limit=5`;
  fetch(url)
    .then(res => {
      if (!res.ok) throw new Error('Network response not ok');
      return res.json();
    })
    .then(data => {
      if (data && data.features) {
        callback(data.features);
      } else {
        callback([]);
      }
    })
    .catch(err => {
      console.error('Lỗi gọi autocomplete:', err);
      callback([]);
    });
}

function setupAutocomplete(inputEl, suggestionEl) {
  inputEl.addEventListener('input', () => {
    const val = inputEl.value.trim();
    fetchSuggestions(val, suggestions => {
      suggestionEl.innerHTML = '';
      if (suggestions.length === 0) {
        suggestionEl.style.display = 'none';
        return;
      }
      suggestions.forEach(s => {
        const div = document.createElement('div');
        div.className = 'suggestion-item';
        div.textContent = s.place_name;
        div.addEventListener('click', () => {
          inputEl.value = s.place_name;
          suggestionEl.style.display = 'none';
          // Bạn có thể lưu tọa độ s.geometry.coordinates nếu cần
          // Ví dụ: console.log('Đã chọn:', s.place_name, s.geometry.coordinates);
        });
        suggestionEl.appendChild(div);
      });
      suggestionEl.style.display = 'block';
    });
  });
  document.addEventListener('click', e => {
    if (!inputEl.contains(e.target) && !suggestionEl.contains(e.target)) {
      suggestionEl.style.display = 'none';
    }
  });
}

setupAutocomplete(document.getElementById('origin'), document.getElementById('origin-suggestions'));
setupAutocomplete(document.getElementById('destination'), document.getElementById('destination-suggestions'));
</script>

</body>
</html>
