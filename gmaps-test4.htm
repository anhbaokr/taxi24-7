<!DOCTYPE html>
<html>
  <head>
    <title>Gợi ý địa chỉ + Tính khoảng cách</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      input {
        width: 300px;
        margin-bottom: 10px;
        padding: 8px;
      }
    </style>
  </head>
  <body>
    <h3>Nhập địa chỉ đi và đến:</h3>
    <input id="origin" type="text" placeholder="Điểm đi" />
    <input id="destination" type="text" placeholder="Điểm đến" />
    <p id="distance"></p>

    <script>
      let autocompleteOrigin;
      let autocompleteDestination;
      let directionsService;
      let directionsRenderer;

      function initMap() {
        const originInput = document.getElementById("origin");
        const destinationInput = document.getElementById("destination");

        autocompleteOrigin = new google.maps.places.Autocomplete(originInput);
        autocompleteDestination = new google.maps.places.Autocomplete(destinationInput);

        directionsService = new google.maps.DirectionsService();
        directionsRenderer = new google.maps.DirectionsRenderer();

        // Khi người dùng chọn xong 2 địa điểm
        [autocompleteOrigin, autocompleteDestination].forEach((autocomplete) => {
          autocomplete.addListener("place_changed", calculateDistance);
        });
      }

      function calculateDistance() {
        const origin = document.getElementById("origin").value;
        const destination = document.getElementById("destination").value;

        if (origin && destination) {
          directionsService.route(
            {
              origin: origin,
              destination: destination,
              travelMode: google.maps.TravelMode.DRIVING,
            },
            (response, status) => {
              if (status === "OK") {
                const distanceText = response.routes[0].legs[0].distance.text;
                document.getElementById("distance").innerText = "Khoảng cách: " + distanceText;
              } else {
                console.error("Lỗi khi tính khoảng cách:", status);
              }
            }
          );
        }
      }
    </script>

    <script
      src="https://maps.googleapis.com/maps/api/js?key=YAIzaSyD16jZhCVtT9b6-nzYhU_ESh6_9aPDMGpU&libraries=places&callback=initMap"
      async
      defer
    ></script>
  </body>
</html>
